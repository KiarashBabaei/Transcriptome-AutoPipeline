# Transcriptome-AutoPipeline

*A fully automated Python workflow for SRA download, FASTQ generation, Salmon quantification, TPM matrix assembly, and SUPPA2 alternative splicing analysis.*

---

## Overview

This repository provides a complete, reproducible, and automated RNA-seq processing pipeline supporting two analysis modes:

### **1. Full-cohort processing**

Processes all samples listed in the SRA metadata (`SraRunTable.txt`).

### **2. Metadata-driven selective processing**

Automatically merges GEO + SRA metadata, extracts biologically relevant sample groups
(e.g., *tumor/high-grade*, *tumor/low-grade*, *normal/healthy*), and runs the transcriptome pipeline only for selected SRR IDs.

The workflow includes:

* Automated SRA acquisition
* FASTQ generation via fasterq-dump
* Salmon indexing and quantification
* TPM matrix construction (SUPPA2-ready)
* SUPPA2 splicing event generation & PSI calculation
* GEOâ€“SRA metadata integration with sample group extraction

---

## ðŸ“‚ Repository Structure

```
Transcriptome-AutoPipeline/

â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ transcriptome_pipeline_all.py        # Full dataset pipeline
â”‚   â”œâ”€â”€ transcriptome_pipeline_selected.py   # Selected-sample pipeline
â”‚   â””â”€â”€ merge_geo_sra.py                     # GEO/SRA metadata integration
â”‚
â”œâ”€â”€ SraRunTable.txt or SraRunTable.csv
â”œâ”€â”€ GSE181294_conditions.csv
â”œâ”€â”€ gencode.v43.transcripts.fa.gz
â”œâ”€â”€ gencode.v43.annotation.gtf(.gz)
â”‚
â”œâ”€â”€ fastq_output/
â”œâ”€â”€ results/
â”œâ”€â”€ salmon_index/
â”œâ”€â”€ events_ioe/
â””â”€â”€ suppa_results/
```

---

#  1. Full-Cohort Pipeline (All SRA Samples)

### **Script**

```
scripts/transcriptome_pipeline_all.py
```

### **Run**

```bash
python3 scripts/transcriptome_pipeline_all.py
```

### **Steps Performed Automatically**

| Step | Description                               |
| ---- | ----------------------------------------- |
| 1    | Create output directories                 |
| 2    | Parse SRR IDs from SraRunTable.txt        |
| 3    | Download `.sra` using prefetch            |
| 4    | Convert to FASTQ using fasterq-dump       |
| 5    | Build Salmon index                        |
| 6    | Run Salmon quantification                 |
| 7    | Build TPM matrix (`TPM_SUPPA2_final.tsv`) |
| 8    | Generate SUPPA2 IOE splicing events       |
| 9    | Calculate PSI values                      |

---

# 2. Metadata Integration & Selective Sample Extraction

### **Script**

```
scripts/merge_geo_sra.py
```

### **Purpose**

Integrates:

* `SraRunTable.csv`
* `GSE181294_conditions.csv`

Produces:

* `merged_SRA_GEO.csv`
* `selected_SRR_ids.txt`

### **Run**

```bash
python3 scripts/merge_geo_sra.py
```

---

#  3. Selected-Sample Pipeline

### **Script**

```
scripts/transcriptome_pipeline_selected.py
```

### **Run**

```bash
python3 scripts/transcriptome_pipeline_selected.py
```

### **Purpose**

Runs the entire transcriptome workflow **only** for SRRs in:

```
selected_SRR_ids.txt
```

Generated by `merge_geo_sra.py`.

---

#  Outputs

### **Expression**

```
TPM_SUPPA2_final.tsv
```

### **Splicing**

```
events_ioe/
suppa_results/RI.psi
```

### **Metadata**

```
merged_SRA_GEO.csv
selected_SRR_ids.txt
```

---

#  Requirements

* Python â‰¥ 3.8
* pandas
* SRA Toolkit
* Salmon
* SUPPA2

NCBI configuration:

```bash
vdb-config -i
```

---

#  Summary

This pipeline provides:

* Reproducible transcriptome-wide quantification
* Automated RNA-seq preprocessing (SRA â†’ FASTQ â†’ TPM)
* Metadata-driven cohort selection
* SUPPA2-ready TPM and PSI outputs
* Full automation from raw data to splicing profiles
